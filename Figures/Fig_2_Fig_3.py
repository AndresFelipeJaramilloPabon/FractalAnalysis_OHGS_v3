# -*- coding: utf-8 -*-
"""
Created on Fri Sep 18 13:56:43 2020

@author: Andrés Jaramillo
"""
# Andrés Felipe Jaramillo Pabón - 201713473

# Libraries


import itertools
import matplotlib.pyplot as plt 
from matplotlib import cm
from scipy.interpolate import griddata
from scipy.stats import linregress
import matplotlib.gridspec as gridspec
from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.axes_grid1 import make_axes_locatable
import numpy as np
import math
from scipy.spatial import ConvexHull
from PIL import Image
import matplotlib.patches as mpatches

gs = gridspec.GridSpec(4,2)

StepSize=10

NumNodes=443
NumReservoirs=4
NumPipes=454

NodesID=[1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
13,
14,
15,
16,
17,
18,
19,
20,
21,
22,
23,
24,
25,
26,
27,
28,
29,
30,
31,
32,
33,
34,
35,
36,
37,
39,
40,
41,
42,
45,
46,
47,
48,
49,
50,
51,
52,
53,
54,
55,
56,
57,
58,
59,
60,
61,
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
141,
142,
143,
144,
145,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
168,
169,
170,
171,
172,
173,
174,
177,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
220,
221,
222,
223,
224,
225,
226,
227,
228,
229,
230,
231,
232,
233,
234,
235,
236,
237,
238,
239,
240,
241,
242,
243,
244,
245,
246,
247,
248,
249,
250,
251,
252,
253,
254,
255,
256,
257,
258,
259,
260,
261,
262,
263,
264,
265,
266,
268,
269,
270,
271,
272,
273,
274,
275,
276,
277,
278,
279,
280,
281,
282,
284,
285,
286,
287,
288,
289,
290,
291,
293,
294,
295,
296,
297,
298,
299,
300,
301,
302,
303,
304,
305,
306,
307,
309,
310,
311,
312,
313,
314,
315,
316,
317,
318,
319,
320,
321,
322,
323,
324,
325,
326,
327,
328,
329,
330,
331,
332,
333,
334,
335,
336,
337,
338,
339,
340,
341,
342,
343,
344,
345,
346,
347,
348,
349,
350,
351,
352,
353,
354,
355,
356,
357,
358,
359,
360,
361,
362,
363,
364,
365,
366,
367,
368,
369,
370,
371,
372,
373,
374,
376,
377,
378,
379,
380,
381,
382,
383,
384,
385,
387,
388,
389,
390,
391,
392,
393,
394,
395,
396,
397,
398,
399,
400,
401,
402,
403,
404,
405,
406,
407,
408,
409,
410,
411,
412,
413,
414,
415,
416,
417,
418,
419,
420,
421,
422,
601,
1791,
24001,
28001,
45001,
46001,
71001,
125001,
127001,
131001,
140001,
159001,
171001,
180001,
180002,
180003,
180004,
190001,
200001,
202001,
215001,
223001,
234001,
235001,
250001,
250002,
250003,
250004,
256001,
257001,
258001,
259001,
260001,
301001,
350001,
360001,
396001,
407001]

NodesX=[-725.47,
-690.4,
-657.28,
-659.83,
-612.48,
-576.76,
-632.5,
-621.05,
-561.83,
-397.94,
-383.95,
-519.62,
-489.75,
-545.6,
-453.39,
-441.16,
-422.09,
-368.06,
-325.47,
-252.74,
-272.22,
-244.05,
-167.75,
-149.91,
-114.73,
-167.75,
-140.04,
-122.06,
-148.12,
-175.46,
-113.16,
-139.22,
-166.45,
-172.28,
-96.43,
-116.88,
-147.46,
-120.13,
-122.84,
-74.78,
-91.39,
-118.15,
-137.72,
-67.91,
-83.6,
-113.91,
-54.38,
-91.72,
-19.37,
-47.35,
-82.52,
10.16,
-16.5,
-38.15,
-61.42,
43.21,
13.97,
-21.92,
-22.26,
77.18,
35.98,
12.72,
-14.88,
107.95,
122.02,
128.52,
139.88,
166.94,
191.73,
-19.08,
-41.33,
1.89,
10.79,
-8.49,
9.44,
12,
5.6,
3.04,
81.99,
-25.15,
-50,
-73.81,
-28.99,
-50.13,
-69.3,
-104.9,
-78.2,
-64.85,
-49.59,
-59.52,
-50.43,
-29.89,
-27.98,
-21.1,
-13.53,
-8.12,
-12.34,
10.16,
12.77,
24.89,
27.96,
47.66,
85.17,
106.28,
118.97,
133.06,
143.95,
141.77,
147.15,
158.04,
134.98,
143.67,
155.78,
174.89,
169.16,
143.65,
134.01,
131.11,
119.52,
85.8,
101.6,
133.06,
92.79,
121.89,
134.33,
148.13,
122.43,
122.03,
135.15,
151.92,
95.64,
110.8,
141.91,
148.4,
107.82,
92.18,
132.76,
118.42,
128.7,
141.42,
112.28,
120.76,
155.57,
136.02,
50.51,
39.15,
-4.6,
-7.85,
-28.41,
-36.88,
-8.93,
6.22,
-47.94,
-68.06,
43.97,
43.85,
43.97,
30.17,
44.14,
59.39,
74,
87.26,
44.51,
56.68,
66.96,
45.59,
62.44,
15.3,
53.44,
147.15,
114.41,
116.41,
101.25,
94.46,
148.43,
131.14,
116.41,
116.41,
130.5,
89.51,
78.62,
86.94,
72.21,
101.25,
109.36,
100.57,
116.2,
131.15,
86.94,
74.77,
86.94,
90.38,
111.9,
125.11,
143.47,
161.24,
186.87,
188.91,
188.91,
127.71,
128.36,
202.5,
89.51,
76.69,
89.51,
89.51,
103.6,
49.66,
38.38,
38.38,
27.75,
27.75,
53.84,
53.22,
42.59,
20.03,
120.13,
-0.01,
188.23,
174.64,
173.96,
152.9,
202.76,
202.76,
179.46,
168.29,
168.29,
130.3,
168.44,
195.83,
173.41,
195.83,
195.14,
195.83,
195.83,
195.14,
164.45,
127.76,
-4.22,
-4.46,
-7,
-10.18,
19.06,
41.94,
49.57,
61.01,
43.85,
43.21,
41.94,
-26.99,
-41.32,
-60.44,
4.32,
30.52,
47.87,
-5.84,
-18.36,
-36.58,
-43.24,
-61.04,
-49.59,
-2.56,
23.42,
32.22,
-5.73,
-24.03,
-45.67,
-64.29,
-64.72,
2.53,
37.57,
29.31,
17.88,
6.97,
-8.91,
-27.06,
-38.31,
-15.27,
-22.9,
-41.77,
-45.24,
-58.23,
-72.51,
-78.57,
-100.22,
-184.64,
-162.22,
-100.73,
-115.46,
-129.09,
-140.26,
-125.07,
-134.68,
-77.29,
-88.53,
-70.17,
-105.84,
-122.29,
-122.73,
-138.74,
-156.06,
-156.49,
-167.32,
-159.45,
-150.05,
-143,
-184.74,
-210.07,
-166.56,
-127.15,
-149.39,
-148.77,
-164.78,
-182.71,
-132.75,
-91.55,
-80.11,
-105.53,
-143,
-167.34,
-125.24,
-144.31,
-110.71,
-104.26,
-65.26,
-39.61,
-38.15,
-38.15,
-43.51,
-172.28,
-184.35,
-193.89,
-205.33,
-209.15,
-225.67,
-258.73,
-252.09,
-252.09,
-254.69,
-257.93,
-271.57,
-281.31,
-300.79,
-226.91,
-214.1,
-179.98,
-151.94,
-208.98,
-182.71,
-115.07,
-163.38,
-177.59,
-185.28,
-169.9,
-200.65,
-212.8,
-240.73,
-229.36,
-220.27,
-278.71,
-283.8,
-253.94,
-227.66,
-239.61,
-244.38,
-230.05,
-375.78,
-370.27,
-469.2,
-499.49,
-518.97,
-541.7,
-562.48,
-570.27,
-581.96,
-593.65,
-615.73,
-638.45,
-625.47,
-392.85,
-373.15,
-426.59,
-441.69,
-466.94,
-481.75,
-471.3,
-414.75,
-387.66,
-339.61,
-277.27,
-168.18,
-127.92,
-101.3,
-60.39,
-29.56,
53.89,
64.77,
69.81,
110.71,
130.5,
107.47,
102.92,
100.32,
96.43,
166.53,
-422.33,
60.74,
-133,
-126.51,
-49.99,
-41.02,
167.38,
116.41,
102.33,
107.55,
79.73,
-57.81,
45.86,
128.39,
90.26,
74.24,
72.94,
86.98,
86.94,
47.87,
37.41,
50.94,
202.76,
202.88,
40.58,
-6.57,
-5.93,
45.31,
15.21,
7.52,
12.06,
38.9,
-0.01,
-144.94,
-242.21,
-199.37,
-417.01,
-235.71]

NodesY=[529.92,
518.23,
539.01,
495.3,
472.13,
497.45,
450.81,
462.25,
418.23,
335.75,
352.91,
486.41,
461.74,
497.45,
435.11,
454.62,
436.19,
362.45,
324.95,
311.09,
287.71,
268.09,
272.29,
274.95,
289.15,
261.47,
248.48,
206.71,
202.9,
213.7,
180.65,
171.11,
158.01,
178.74,
138.1,
128.65,
125.41,
117.02,
103.49,
84.42,
75.59,
68.58,
61.28,
22.86,
21.78,
17.45,
-9.6,
-17.72,
-30.74,
-50.19,
-49.11,
-74.25,
-86.99,
-88.07,
-86.99,
-148.62,
-146.72,
-117.56,
-147.35,
-215.62,
-215.77,
-211.99,
-196.83,
-225.51,
-238.5,
-260.69,
-234.71,
-226.6,
-242.44,
363.08,
351.64,
373.26,
309.69,
308.35,
272.48,
248.78,
230.84,
287.21,
344.65,
295.54,
294.81,
291.34,
277.6,
262.87,
241.04,
229.6,
142.51,
145.05,
150.14,
178.35,
201.73,
150.77,
120.9,
106.47,
91.31,
150.03,
182.25,
153.95,
169.7,
174.46,
157.77,
155.22,
169.21,
188.31,
187.93,
185.37,
194.33,
176.88,
166.79,
158.47,
241.26,
241.26,
236.76,
215.74,
231.66,
267.1,
292.45,
311.77,
330.13,
152.04,
150.03,
148.86,
120.9,
102.68,
99.97,
105.38,
57.22,
70.68,
61.55,
64.53,
0.14,
0.14,
17.99,
1.49,
-9.33,
-42.84,
-49.33,
-38.51,
-26.06,
-32.29,
-106.2,
-129.55,
-139.75,
-160.7,
-43.11,
-43.65,
-27.73,
21.51,
18.8,
38.9,
52.9,
61.01,
59.31,
115.55,
133.25,
121.53,
109.17,
108.36,
96.37,
97.54,
101.6,
105.65,
81.57,
67.23,
67.23,
38.83,
40.96,
27.6,
12.58,
757.99,
753.38,
683.69,
682.42,
664.08,
579.93,
579.93,
579.93,
547.26,
547.26,
579.93,
579.93,
510.75,
510.75,
509.83,
500.5,
465.66,
465.66,
457.5,
465.91,
465.91,
439.65,
428.28,
424.68,
424.68,
424.35,
424.92,
433.72,
416.73,
400.42,
411.47,
393.72,
456.82,
415.31,
415.31,
401.22,
387.77,
396.1,
382.17,
382.29,
365.87,
345.58,
330.13,
336.89,
322.52,
302.23,
411.27,
361.18,
387.88,
497.59,
497.59,
484,
484,
498.48,
558.23,
540.26,
540.21,
531.89,
532.81,
515.64,
594.02,
594.02,
614.51,
636.42,
659.35,
682.41,
705.07,
704.83,
705.07,
716.23,
700.62,
680.92,
656.76,
719.06,
718.42,
727.95,
740.03,
677.1,
642.78,
613.54,
595.82,
571.93,
586.27,
570.96,
523.81,
523.94,
523.81,
526.58,
547.19,
531.54,
555.69,
516.91,
492.76,
493.76,
500.19,
475.6,
493.51,
493.94,
487.45,
475.32,
455.26,
442.71,
438.07,
439.63,
430.28,
434.91,
435.5,
435.07,
411.4,
389.78,
390.48,
402.16,
393.94,
397.4,
414.29,
426.84,
479.36,
471.04,
403.14,
410.19,
412.16,
416.23,
435.81,
440.93,
382.77,
365.8,
361.41,
359.31,
354.11,
326.41,
347.19,
347.62,
324.68,
316.88,
377.38,
387.13,
394.18,
399.03,
398.38,
429.19,
567.77,
556.33,
567.76,
568.4,
569.04,
592.1,
525.81,
528.99,
584.93,
617.72,
608.11,
644.05,
701.89,
705.84,
671.38,
709.09,
711.04,
695.54,
677.1,
657.47,
698.71,
677.74,
652.31,
626.88,
602.73,
691.72,
645.32,
585.11,
563.03,
550.7,
537.06,
582.52,
563.68,
564.98,
537.01,
534.45,
530.49,
530.9,
512.67,
507.55,
532.81,
501.02,
449.26,
440.93,
457.59,
447.34,
461.09,
465.63,
482.19,
480.57,
474.72,
450.1,
445.32,
433.37,
415.46,
393.96,
384.4,
463.24,
489.66,
504.69,
523.42,
537.06,
554.59,
557.19,
566.93,
577.97,
589.01,
605.24,
611.74,
579.92,
553.78,
541.07,
596.35,
610.43,
619.13,
605.2,
588.66,
646.06,
674.35,
693.18,
684.09,
748.38,
769.16,
784.09,
802.27,
815.86,
805.31,
832.94,
855.52,
868.51,
886.73,
848.38,
822.4,
804.22,
775,
836.65,
496.3,
-12.58,
276.98,
224.51,
31.63,
13.42,
-237.03,
147.58,
101.19,
53.71,
-42.84,
85.45,
62.36,
752.75,
735.93,
703.03,
601.3,
553.99,
451.82,
439.65,
413.2,
350.41,
532.17,
578,
843.83,
770.16,
744.54,
758.63,
629.24,
582.49,
600.82,
587.61,
550.61,
492.76,
640.58,
531.89,
569.04,
725.65]

NodesZ=[13.2,
16.5,
23.9,
14.2,
12.5,
18.4,
10,
8.5,
1.7,
3.3,
4,
15,
12.4,
19.25,
6.7,
8.1,
10,
8,
3.2,
11,
4.8,
5.2,
7.5,
10,
14.5,
12.3,
31.2,
22.5,
9.2,
5.65,
20,
7.1,
4.6,
4.4,
30,
13,
6,
10,
6.3,
31,
15,
5.9,
3.5,
13.1,
7.1,
1.6,
20,
4.4,
31,
14.5,
4.1,
30,
12.9,
4.8,
3,
21,
11,
5,
3.5,
9,
4.5,
3.3,
1.2,
12.3,
9.3,
8.16,
8.8,
8.1,
7.4,
32.5,
40,
47,
47.4,
45,
44.8,
45.8,
46.6,
44.4,
46.9,
40.2,
40,
50,
41.4,
40.3,
47,
45,
42.5,
40,
50,
51.7,
51.4,
52.8,
51.4,
46,
45,
53.1,
51.2,
54.5,
51.5,
52.4,
55.8,
54,
50,
46.2,
48.6,
47.6,
47.1,
45.6,
47.9,
46,
50,
50,
47.5,
45,
46,
49.5,
50,
49.3,
47.3,
52.2,
51.1,
49.3,
56.5,
55,
52.3,
50.2,
52.4,
55,
46.6,
28.8,
60,
43.3,
25,
23.6,
42.5,
50,
24,
38.3,
36.8,
27,
33,
29,
19,
45,
56.5,
55,
34,
41.6,
34,
34.2,
40,
46,
31.4,
32.9,
55,
55.2,
55.2,
57.8,
56.7,
57.3,
57.1,
56.5,
60,
60,
60,
59.3,
60,
58.9,
60,
95,
93,
95,
87.7,
85.7,
95,
95,
95,
94.2,
90.5,
95,
91.8,
95,
85,
95,
95,
92.7,
90,
89.6,
94,
77.8,
95,
94.2,
92.9,
91.4,
84.2,
80.6,
76.8,
70,
70,
90.8,
65,
73.8,
74,
60,
62.7,
62,
57.25,
50,
52.3,
51.7,
52,
50.8,
50.1,
49.5,
50.7,
52.8,
49.8,
49.6,
72.5,
80.5,
84.2,
87.17,
65,
71.5,
76,
83,
81.3,
86.3,
83,
83.3,
87.8,
83.6,
78.1,
83.5,
85,
90.8,
95,
94.1,
83,
82.5,
78.8,
78.8,
83.9,
82.6,
84,
87,
83.5,
83.3,
81.5,
76.4,
76,
75.8,
70.5,
70,
71.4,
65,
66,
73.7,
72.4,
73.4,
70,
65.5,
66,
71,
60,
67.2,
71.4,
73.6,
75,
66.8,
70,
71,
72,
73.3,
55,
71,
68,
49,
47.6,
48.5,
51.4,
51.7,
52,
55,
60,
75,
75.2,
50,
50,
50.8,
51,
54.8,
54.8,
50,
45.7,
48.4,
45.6,
45,
40,
45,
46,
40,
35,
46.9,
47.5,
50,
47.4,
44,
53.4,
75,
75.7,
76.5,
77,
77.7,
75.3,
75.7,
75,
80,
80.2,
80.4,
80,
84.36,
81.1,
81.6,
83.54,
83.6,
82.8,
82.2,
80.2,
84.4,
84.1,
83.1,
82.9,
82.76,
84.2,
83.6,
82.1,
81.8,
81.5,
81.1,
82.3,
82.1,
82,
80.7,
80.6,
79.5,
80,
80.5,
80,
79.7,
79.4,
59.8,
58,
59.2,
59.5,
59.2,
57.2,
68,
69.5,
56.2,
52.7,
56.6,
53,
50.5,
45,
45,
52.7,
56,
54.7,
54.8,
54.8,
55.5,
52.5,
53,
52,
50,
56.4,
55.6,
40.4,
80.5,
80.5,
81.7,
81.7,
81.7,
80.8,
80.9,
83.74,
84.3,
84.4,
84.5,
86.7,
87,
89.7,
89.7,
90,
100,
102,
103,
103,
104,
103,
101.1,
99.8,
98.1,
103,
56,
60,
10,
32.2,
32,
33,
8.1,
49.4,
56,
57,
55.5,
34,
60,
95.6,
95,
90,
84.2,
95,
95,
70,
75,
54.5,
65,
75.5,
100,
88.6,
86,
85,
75,
71,
74.4,
71.6,
75.3,
75,
83.7,
80.5,
80.4,
85]

NodesHGL=[43.7015,
44.3129,
43.9411,
50.7893,
61.91,
68.712,
53.895,
54.1732,
53.4653,
44.2618,
44.6198,
85.9966,
93.2562,
75.8118,
64.5085,
64.2495,
64.1559,
45.3549,
45.1487,
44.9336,
45.3853,
46.161,
49.1573,
47.0992,
44.4193,
50.4293,
62.7522,
90.5929,
87.9869,
87.4223,
89.1284,
84.2413,
83.9659,
83.8309,
83.9637,
77.9664,
77.5036,
76.6586,
76.2179,
78.8373,
74.3873,
72.4591,
72.0129,
62.6047,
61.3734,
60.6737,
65.3778,
64.4909,
62.3127,
60.7759,
60.0404,
51.4853,
48.3267,
46.9521,
46.5444,
43.2374,
36.2843,
35.7086,
35.7003,
38.4691,
35.0521,
34.0021,
33.3135,
40.6125,
42.5959,
42.2571,
48.1674,
55.216,
54.6631,
106.6331,
106.2833,
108.3036,
105.5333,
105.7151,
93.0744,
91.9862,
91.73,
94.5246,
106.2215,
103.8475,
102.2343,
101.7908,
103.1867,
102.1788,
100.0117,
98.9081,
91.9063,
93.919,
94.4551,
93.4051,
92.8404,
96.1381,
90.4167,
89.1757,
88.8259,
98.6039,
98.0613,
99.5211,
97.8315,
97.5974,
100.0203,
100.4848,
91.0588,
85.1294,
81.0797,
74.3723,
74.2043,
68.7701,
67.9301,
67.561,
90.1335,
88.7933,
85.0387,
82.5002,
83.12,
100.7277,
101.7203,
103.7084,
105.1691,
98.131,
94.873,
92.212,
92.52,
89.867,
88.4447,
87.9626,
83.8925,
83.5234,
82.5848,
81.9705,
84.851,
78.4517,
77.2398,
77.1874,
77.9449,
80.6394,
79.2346,
74.6796,
73.5723,
73.0269,
76.4494,
74.4743,
74.0749,
66.3283,
76.6334,
76.1357,
75.9192,
76.0495,
76.3663,
78.6439,
76.8207,
76.4654,
81.7343,
84.9908,
98.8482,
97.8523,
95.7181,
95.2664,
92.5119,
90.565,
89.1809,
88.8696,
90.0988,
85.5517,
85.2762,
83.7266,
83.2996,
80.2842,
80.5679,
124.0504,
123.3491,
122.5887,
121.6055,
121.3714,
119.8837,
120.0985,
120.4612,
119.4632,
117.13,
119.2148,
119.022,
118.5141,
118.2304,
117.5023,
116.9679,
114.4122,
112.2645,
112.0083,
117.5908,
117.1556,
115.7206,
114.8049,
112.9623,
111.8836,
110.429,
109.9349,
109.4087,
106.6977,
105.8769,
111.1486,
110.4077,
109.2477,
102.9267,
102.0205,
100.0462,
99.8919,
99.5751,
91.3337,
91.6229,
86.3506,
85.5297,
85.1826,
75.6701,
73.1023,
72.9866,
110.8968,
106.0177,
110.2754,
109.1889,
108.2444,
107.5148,
107.2228,
109.6089,
110.4934,
111.9978,
112.3779,
113.7716,
114.756,
113.6504,
113.0438,
112.5756,
114.3971,
115.6308,
117.4489,
119.7159,
120.767,
122.3245,
122.9415,
115.6532,
113.8653,
112.2043,
112.0638,
113.3939,
108.5933,
108.1064,
107.5225,
106.1497,
105.3288,
105.1057,
99.7315,
99.9464,
99.6985,
107.2702,
105.0886,
115.6086,
105.7139,
102.7946,
95.4975,
95.7923,
95.1863,
94.9659,
101.3604,
100.5013,
100.124,
99.282,
97.703,
96.5707,
95.3437,
95.1179,
99.4603,
106.6654,
105.2946,
103.7196,
103.491,
100.1229,
98.1087,
97.9187,
104.3434,
105.8664,
105.0723,
103.4079,
103.7715,
103.0982,
102.0482,
101.5469,
100.7609,
101.3917,
91.7588,
86.5747,
83.8273,
80.7084,
79.2765,
79.1498,
102.3518,
99.3273,
99.0105,
95.9341,
92.542,
92.0737,
85.6917,
82.6522,
80.9626,
80.6376,
84.8862,
84.2848,
83.4199,
89.1822,
88.455,
100.9948,
106.1273,
101.0262,
101.3292,
100.6992,
100.4265,
108.1597,
110.1696,
109.9823,
111.0115,
110.6235,
110.1222,
112.0603,
112.6468,
113.8546,
113.177,
114.4836,
115.1313,
113.403,
112.792,
112.1502,
115.0572,
109.4285,
104.2037,
103.4019,
103.2642,
117.6133,
111.5572,
104.7601,
102.7337,
102.0751,
101.7418,
103.9763,
103.2031,
102.9387,
100.8141,
100.9766,
102.2245,
102.6968,
100.6666,
101.0577,
102.985,
101.8309,
97.5852,
98.072,
97.3456,
96.2654,
94.5297,
91.7546,
89.7596,
89.575,
91.7837,
87.4222,
87.8904,
82.2952,
80.6861,
78.5383,
78.4171,
92.6363,
93.0385,
97.9608,
92.596,
91.0072,
89.347,
85.7382,
84.1183,
83.1255,
81.5197,
76.4142,
75.6028,
75.1869,
101.4056,
101.3202,
105.644,
104.9309,
104.1384,
101.3033,
101.0747,
109.9165,
112.5947,
115.4927,
117.1093,
119.8673,
121.1277,
121.3324,
121.7026,
121.9514,
121.4393,
122.1934,
123.296,
123.8908,
124.5449,
123.499,
121.4332,
120.7883,
118.1824,
124.7593,
93.9516,
80.1051,
45.0087,
91.9636,
75.5364,
67.1342,
54.9964,
92.3911,
91.8933,
89.3872,
77.4177,
83.678,
86.4299,
123.7071,
115.4575,
114.6587,
114.4834,
119.0323,
116.4897,
113.5673,
112.2351,
77.9745,
110.4959,
111.0565,
122.7797,
116.3187,
116.0988,
119.3735,
111.8649,
108.243,
109.6338,
108.7524,
106.8001,
102.1458,
111.7638,
101.5398,
103.5247,
118.5581]

Nodes=list()

for i in range(NumNodes):
    Var=dict()
    Var['ID']=NodesID[i]
    Var['X']=NodesX[i]
    Var['Y']=NodesY[i]
    Var['Z']=NodesZ[i]
    Var['HGL']=NodesHGL[i]
    Nodes.append(Var)
    
ReservoirsID=[38,
43,
44,
88,]

ReservoirsX=[52.15,
192.62,
30.17,
-567.07]

ReservoirsY=[481.54,
913.46,
822.68,
714.7]

ReservoirsZ=[117,
127,
122,
112]

ReservoirsHGL=[117,
127,
122,
112]

Reservoirs=list()

for i in range(NumReservoirs):
    Var=dict()
    Var['ID']=ReservoirsID[i]
    Var['X']=ReservoirsX[i]
    Var['Y']=ReservoirsY[i]
    Var['Z']=ReservoirsZ[i]
    Var['HGL']=ReservoirsHGL[i]
    Reservoirs.append(Var)

PipesID=[1,
2,
3,
4,
5,
8,
10,
11,
12,
13,
15,
16,
17,
18,
19,
20,
21,
22,
23,
24,
26,
27,
28,
30,
32,
33,
34,
35,
38,
39,
40,
41,
42,
43,
44,
46,
47,
49,
50,
51,
52,
53,
56,
57,
58,
59,
61,
62,
63,
64,
65,
67,
68,
69,
70,
71,
73,
74,
75,
77,
78,
81,
82,
83,
84,
86,
87,
88,
89,
90,
91,
92,
94,
95,
96,
97,
98,
99,
101,
102,
103,
104,
105,
106,
107,
108,
110,
112,
113,
114,
115,
116,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
131,
132,
133,
134,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
157,
159,
160,
161,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
179,
181,
182,
183,
184,
185,
186,
187,
188,
190,
191,
192,
193,
194,
196,
197,
198,
199,
200,
201,
202,
204,
206,
207,
208,
209,
212,
213,
214,
216,
218,
219,
220,
221,
222,
223,
224,
226,
227,
228,
229,
230,
231,
232,
234,
235,
236,
237,
238,
239,
240,
243,
244,
245,
246,
247,
248,
249,
251,
254,
255,
256,
257,
258,
259,
260,
261,
262,
263,
265,
266,
267,
268,
269,
271,
272,
273,
274,
275,
276,
277,
278,
279,
280,
282,
284,
288,
289,
290,
291,
292,
294,
295,
296,
297,
298,
299,
300,
301,
302,
304,
306,
307,
308,
311,
312,
313,
315,
316,
317,
318,
321,
322,
323,
324,
325,
328,
329,
330,
331,
332,
333,
334,
335,
336,
337,
338,
342,
343,
344,
345,
346,
348,
349,
350,
351,
352,
353,
354,
355,
356,
357,
358,
359,
361,
362,
363,
364,
365,
366,
367,
368,
369,
370,
373,
374,
375,
376,
379,
380,
381,
382,
383,
385,
386,
390,
392,
393,
394,
397,
398,
399,
400,
401,
402,
404,
405,
406,
407,
408,
409,
414,
415,
416,
417,
418,
419,
421,
422,
423,
424,
428,
429,
430,
433,
434,
435,
438,
439,
441,
442,
443,
446,
450,
457,
458,
459,
460,
464,
465,
467,
468,
469,
471,
472,
473,
474,
476,
477,
479,
480,
481,
482,
485,
486,
487,
489,
490,
492,
496,
497,
498,
499,
500,
501,
503,
506,
508,
509,
510,
511,
512,
513,
514,
515,
517,
519,
520,
521,
522,
523,
524,
525,
526,
530,
532,
535,
536,
537,
538,
539,
540,
542,
543,
544,
545,
546,
547,
548,
549,
550,
552,
554,
555,
557,
558,
563,
564,
565,
567,
568,
571,
575,
576,
578,
579,
580,
581,
588,
589,
590,
593,
600,
601,
605,
606,
607,
608,
609,
610,
611,
612,
613,
614,
615,
616,
617,
618,
620]

PipesNI=[126,
125001,
125,
124,
266,
106,
161,
162,
163,
163,
165,
166,
165,
170,
171001,
171,
171001,
173,
173,
106,
179,
179,
168,
124,
128,
129,
127001,
131,
106,
105,
131001,
131,
133,
131001,
135,
136,
136,
102,
136,
385,
100,
102,
141,
143,
144,
141,
141,
140001,
151,
269,
124,
107,
108,
109,
110,
110,
112,
113,
115,
115,
116,
119,
117,
103,
100,
96,
97,
98,
96,
83,
93,
94,
93,
92,
91,
160,
159001,
159,
156,
157,
156,
155,
155,
234001,
77,
55,
59,
60,
60,
141,
147,
148,
148,
59,
63,
63,
64,
65,
260001,
67,
68,
68,
70,
152,
55,
56,
57,
52,
53,
55,
52,
46001,
50,
46001,
47,
48,
301001,
41,
42,
45,
45001,
41,
35,
36,
39,
36,
35,
31,
32,
32,
235,
91,
250001,
13,
90,
23,
31,
28001,
28,
29,
90,
28001,
27,
26,
23,
220,
213,
24,
234001,
288,
365,
24001,
319,
250002,
322,
81,
78,
79,
43,
325,
46001,
84,
115,
120,
121,
122,
77,
238,
192,
77,
123,
73,
336,
334,
239,
135,
75,
219,
150,
83,
43,
220,
221,
222,
221,
223001,
224,
225,
370,
256001,
258001,
257001,
264,
265,
268,
274,
83,
215,
214,
216,
216,
256001,
214,
215001,
203,
204,
204,
211,
205,
206,
207,
208,
208,
209,
203,
405,
86,
201,
200001,
234,
230,
231,
232,
199,
196,
197,
199,
192,
194,
192,
234,
236,
237,
250004,
238,
190001,
187,
186,
187,
188,
180004,
235001,
241,
241,
243,
244,
182,
183,
187,
182,
249,
248,
247,
246,
180001,
180001,
71,
187,
190,
180004,
180002,
180,
400,
404,
258001,
199,
202001,
287,
286,
285,
399,
202001,
274,
275,
89,
229,
268,
271,
202001,
318,
317,
316,
315,
313,
313,
312,
310,
310,
309,
297,
298,
297,
296,
294,
293,
293,
71001,
296,
127,
288,
289,
288,
282,
277,
278,
279,
280,
127001,
271,
271,
82,
227,
227,
268,
262,
301001,
303,
319,
262,
304,
255,
258,
259,
255,
256,
255,
421,
420,
419,
418,
416,
417,
416,
415,
415,
414,
22,
21,
19,
422,
319,
21,
297,
302,
305,
306,
320,
322,
301,
324,
368,
367,
365,
365,
362,
361,
360001,
360,
366,
364,
325,
327,
327,
328,
330,
324,
331,
333,
331,
254,
250,
341,
340,
338,
338,
341,
342,
343,
250,
251,
252,
250002,
412,
411,
410,
409,
408,
407001,
407001,
407,
350,
350001,
350001,
350001,
350,
345,
346,
347,
348,
334,
406,
352,
353,
354,
356,
357,
368,
371,
372,
373,
372,
378,
379,
380,
381,
372,
376,
384,
378,
396001,
397,
400,
401,
402,
18,
11,
9,
18,
15,
12,
14,
6,
5,
13,
15,
15,
250,
4,
8,
601,
601,
385,
387,
388,
389,
390,
391,
392,
393,
394,
395,
4,
2,
2]

PipesNF=[125001,
125,
124,
106,
38,
161,
162,
163,
164,
165,
166,
168,
170,
171001,
171,
172,
173,
179,
174,
82,
1791,
177,
169,
127,
129,
130,
131001,
132,
105,
102,
131,
133,
134,
135,
136,
137,
138,
100,
139,
88,
101,
103,
143,
144,
145,
142,
140001,
151,
152,
271,
107,
108,
109,
110,
111,
112,
113,
114,
108,
116,
117,
118,
119,
104,
96,
97,
98,
99,
93,
77,
94,
95,
92,
91,
160,
159001,
159,
156,
157,
158,
155,
154,
153,
235,
81,
59,
60,
61,
62,
147,
148,
150,
149,
63,
67,
64,
65,
66,
262,
68,
69,
70,
71,
153,
56,
57,
58,
53,
54,
52,
46001,
50,
51,
47,
48,
49,
366,
42,
45,
46,
41,
35,
36,
39,
40,
37,
31,
32,
33,
34,
235001,
90,
412,
385,
89,
24,
28,
28,
29,
30,
28001,
27,
26,
23,
22,
215001,
234,
24001,
238,
291,
301001,
25,
322,
44,
324,
78,
79,
80,
417,
330,
45001,
85,
120,
121,
122,
123,
75,
240,
190001,
76,
82,
74,
337,
345,
189,
141,
73,
220,
71,
84,
422,
221,
222,
223,
223001,
224,
225,
226,
371,
258001,
257001,
264,
260001,
268,
274,
277,
86,
214,
216,
217,
218,
254,
203,
202001,
204,
205,
211,
212,
206,
207,
208,
213,
209,
210,
201,
404,
87,
200001,
199,
230,
231,
232,
233,
196,
197,
198,
192,
194,
195,
193,
234001,
237,
238,
413,
239,
190,
186,
185,
188,
189,
266,
241,
242,
243,
244,
245,
183,
184,
182,
249,
248,
247,
246,
245,
249,
181,
71001,
190,
191,
180003,
180003,
180001,
399,
399,
259001,
200,
284,
286,
285,
284,
396001,
38,
275,
276,
87,
75,
269,
270,
82,
317,
316,
315,
313,
314,
312,
310,
311,
309,
297,
298,
299,
296,
294,
293,
229,
291,
72,
295,
127001,
289,
290,
282,
277,
278,
279,
280,
281,
128,
272,
273,
228,
229,
215001,
260001,
261,
301,
304,
315,
263,
305,
258,
259,
260,
256,
257,
254,
180002,
421,
420,
419,
418,
416,
415,
250001,
414,
413,
21,
19,
18,
180,
320,
20,
302,
303,
306,
307,
321,
323,
300,
368,
367,
369,
325,
362,
361,
360001,
360,
359,
364,
363,
327,
326,
328,
329,
334,
331,
333,
336,
332,
250,
341,
340,
338,
337,
339,
342,
343,
344,
251,
252,
253,
250003,
411,
410,
409,
408,
407001,
406,
350,
350,
350001,
351,
352,
356,
345,
346,
347,
348,
349,
335,
405,
353,
354,
355,
357,
358,
370,
372,
373,
374,
378,
379,
380,
381,
382,
376,
384,
383,
377,
397,
398,
401,
402,
403,
11,
10,
8,
15,
13,
14,
6,
5,
8,
12,
16,
17,
250003,
8,
7,
384,
385,
387,
388,
389,
390,
391,
392,
393,
394,
395,
396,
2,
3,
1]

Pipes=list()

for i in range(NumPipes):
    Var=dict()
    Var['ID']=PipesID[i]
    Var['NI']=PipesNI[i]
    Var['NF']=PipesNF[i]
    Pipes.append(Var)

NodesX=list()
NodesY=list()
NodesZ=list()

for i in range(len(Reservoirs)):
    NodesX.append(Reservoirs[i]['X'])
    NodesY.append(Reservoirs[i]['Y'])
    NodesZ.append(Reservoirs[i]['Z'])
    
for i in range(len(Nodes)):
    NodesX.append(Nodes[i]['X'])
    NodesY.append(Nodes[i]['Y'])
    NodesZ.append(Nodes[i]['Z'])
    
fig=plt.figure(dpi=600)
ax = fig.add_subplot(gs[0:2, 0:3],projection='3d')
fig.set_size_inches(15, 15)
ax.scatter(NodesX, NodesY, NodesZ, c='black', marker='o', alpha=1)

for i in range(len(Pipes)):
    NI=Pipes[i]['NI']
    NF=Pipes[i]['NF']
    X=list()
    Y=list()
    Z=list()
    v=None
    for i in range(len(Reservoirs)):
        v=Reservoirs[i]['ID']
        if v==NI:
            X.append(Reservoirs[i]['X'])
            Y.append(Reservoirs[i]['Y'])
            Z.append(Reservoirs[i]['Z'])
            break
    for i in range(len(Nodes)):
        v=Nodes[i]['ID']
        if v==NI:
            X.append(Nodes[i]['X'])
            Y.append(Nodes[i]['Y'])
            Z.append(Nodes[i]['Z'])
            break
    for i in range(len(Reservoirs)):
        v=Reservoirs[i]['ID']
        if v==NF:
            X.append(Reservoirs[i]['X'])
            Y.append(Reservoirs[i]['Y'])
            Z.append(Reservoirs[i]['Z'])
            break
    for i in range(len(Nodes)):
        v=Nodes[i]['ID']
        if v==NF:
            X.append(Nodes[i]['X'])
            Y.append(Nodes[i]['Y'])
            Z.append(Nodes[i]['Z'])
            break
    plt.plot(X,Y,Z,color='darkblue')  


HGLX=list()
HGLY=list()
HGLZ=list()

for i in range(len(Pipes)):
    NI=Pipes[i]['NI']
    NF=Pipes[i]['NF']
    for i in range(len(Reservoirs)):
        v=Reservoirs[i]['ID']
        if v==NI:
            Xo=Reservoirs[i]['X']
            Yo=Reservoirs[i]['Y']
            Zo=Reservoirs[i]['HGL']
            HGLX.append(Xo)
            HGLY.append(Yo)
            HGLZ.append(Zo)
            break
    for i in range(len(Nodes)):
        v=Nodes[i]['ID']
        if v==NI:
            Xo=Nodes[i]['X']
            Yo=Nodes[i]['Y']
            Zo=Nodes[i]['HGL']
            HGLX.append(Xo)
            HGLY.append(Yo)
            HGLZ.append(Zo)
            break
    for i in range(len(Reservoirs)):
        v=Reservoirs[i]['ID']
        if v==NF:
            Xf=Reservoirs[i]['X']
            Yf=Reservoirs[i]['Y']
            Zf=Reservoirs[i]['HGL']
            HGLX.append(Xf)
            HGLY.append(Yf)
            HGLZ.append(Zf)
            break
    for i in range(len(Nodes)):
        v=Nodes[i]['ID']
        if v==NF:
            Xf=Nodes[i]['X']
            Yf=Nodes[i]['Y']
            Zf=Nodes[i]['HGL']
            HGLX.append(Xf)
            HGLY.append(Yf)
            HGLZ.append(Zf)
            break 
    for i in range(10):
        HGLX.append(Xo+(i/10)*(Xf-Xo))
        HGLY.append(Yo+(i/10)*(Yf-Yo))
        HGLZ.append(Zo+(i/10)*(Zf-Zo))

Xmax=max(HGLX)
Ymax=max(HGLY)
Xmin=min(HGLX)
Ymin=min(HGLY)

grid_x , grid_y=np.mgrid[Xmin:Xmax:StepSize,Ymin:Ymax:StepSize]

HGLInt1=griddata((HGLX,HGLY),HGLZ,(grid_x,grid_y),method='linear')
HGLInt2=np.nan_to_num(HGLInt1, copy=True, nan=0.0, posinf=None, neginf=None)
surf=ax.plot_surface(grid_x,grid_y,HGLInt1,cmap=cm.YlOrRd,vmin=np.nanmin(HGLInt1), vmax=np.nanmax(HGLInt1),rcount=200, ccount=200)

cbar=plt.colorbar(surf,ax=ax,shrink=0.7)
cbar.set_label('HGS [m]', labelpad=-40, y=1.05, rotation=0,fontsize=15)
cbar.ax.tick_params(labelsize=15)

fig.tight_layout()
fig.subplots_adjust(top=0.98)

ax.set_xlim(Xmin,Xmax)
ax.set_ylim(Ymin,Ymax)
ax.set_xlabel('X [m]',fontsize=15,labelpad=20)
ax.set_ylabel('Y [m]',fontsize=15,labelpad=20)
ax.set_zlabel('Z [m]',fontsize=15,labelpad=20)
ax.tick_params(axis='both', which='major', labelsize=12)
plt.tight_layout()
plt.savefig('Fig_2.pdf', dpi=600,bbox_inches='tight')


plt.figure(2,figsize=(2,2),dpi=600)
extent=[Xmin,Xmax,Ymin,Ymax]
plt.imshow(HGLInt1.T,cmap='YlOrRd',origin='lower',extent=extent)

ax = plt.gca()
ax1= plt.gca()
divider = make_axes_locatable(ax)
cax = divider.append_axes("right", size="3%", pad=0.05)
cax.tick_params(labelsize=6)

ax1.grid(True,color='black',linestyle='dotted')
ax1.set_xlabel('X [m]',fontsize=6)
ax1.set_ylabel('Y [m]',fontsize=6)
ax1.set_xticks([-600,-400,-200,0,200])
ax1.set_yticks([-200,0,200,400,600,800])
ax1.tick_params(axis='both', labelsize=6)
plt.colorbar(shrink=0.8,cax=cax).set_label('HGS [m]', labelpad=25,y=0.6, rotation=0,fontsize=6)
plt.savefig('Fig_3.pdf', dpi=600,bbox_inches = 'tight')